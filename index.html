<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jarvis AI Assistant</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #0d1b2a;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .container {
            background-color: #1b263b;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 123, 255, 0.5);
            width: 450px;
            color: #ffffff;
        }
        h1 {
            text-align: center;
            color: #00b4d8;
            font-size: 24px;
            margin-bottom: 20px;
        }
        #conversation {
            height: 350px;
            overflow-y: auto;
            border: 1px solid #415a77;
            border-radius: 5px;
            padding: 15px;
            background-color: #0d1b2a;
            margin-bottom: 15px;
            font-size: 16px;
            line-height: 1.5;
        }
        #conversation p {
            margin: 5px 0;
        }
        #conversation p.user {
            color: #90e0ef;
        }
        #conversation p.jarvis {
            color: #48cae4;
        }
        button {
            width: 100%;
            padding: 12px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #0056b3;
        }
        button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Jarvis AI Assistant</h1>
        <div id="conversation"></div>
        <button id="start-btn">Activate Jarvis</button>
    </div>

    <script>
        // Check browser support for Web Speech API
        if ('webkitSpeechRecognition' in window && 'speechSynthesis' in window) {
            const recognition = new webkitSpeechRecognition();
            recognition.continuous = true;
            recognition.interimResults = false;
            recognition.lang = 'en-US';

            const synth = window.speechSynthesis;
            let voices = [];

            // Load available voices
            function loadVoices() {
                voices = synth.getVoices();
            }
            if (synth.onvoiceschanged !== undefined) {
                synth.onvoiceschanged = loadVoices;
            }
            loadVoices();

            // DOM elements
            const startBtn = document.getElementById('start-btn');
            const conversationDiv = document.getElementById('conversation');

            // Memory to store user details
            let memory = {
                name: '',
                age: ''
            };

            // Append messages to conversation
            function appendMessage(message, className) {
                const p = document.createElement('p');
                p.textContent = message;
                p.className = className;
                conversationDiv.appendChild(p);
                conversationDiv.scrollTop = conversationDiv.scrollHeight;
            }

            // Speak response with a selected voice
            function speak(text) {
                const utterance = new SpeechSynthesisUtterance(text);
                const voice = voices.find(v => v.name.includes('Google UK English Male')) || voices[0];
                if (voice) {
                    utterance.voice = voice;
                    utterance.lang = 'en-GB';
                }
                synth.speak(utterance);
            }

            // Start recognition on button click
            startBtn.addEventListener('click', () => {
                recognition.start();
                startBtn.disabled = true;
                appendMessage('Jarvis: Greetings! I am Jarvis, your personal assistant. How may I assist you?', 'jarvis');
                speak('Greetings! I am Jarvis, your personal assistant. How may I assist you?');
            });

            // Process recognized speech
            recognition.onresult = (event) => {
                const transcript = event.results[event.results.length - 1][0].transcript.trim().toLowerCase();
                appendMessage(`You: ${transcript}`, 'user');
                processCommand(transcript);
            };

            // Handle recognition errors
            recognition.onerror = (event) => {
                console.error('Speech recognition error:', event.error);
                appendMessage('Jarvis: Apologies, sir. I encountered an error. Please try again.', 'jarvis');
                speak('Apologies, sir. I encountered an error. Please try again.');
                recognition.stop();
            };

            // Re-enable button when recognition ends
            recognition.onend = () => {
                startBtn.disabled = false;
            };

            // Process voice commands
            function processCommand(command) {
                let response;
                if (command.includes('hello') || command.includes('hi') || command.includes('hey jarvis')) {
                    response = memory.name ? `Hello, ${memory.name}. How can I assist you today?` : 'Greetings! May I have your name, sir?';
                } else if (command.includes('my name is')) {
                    memory.name = command.split('my name is')[1].trim();
                    response = `Very well, ${memory.name}. It’s a pleasure to meet you.`;
                } else if (command.includes('what is my name') || command.includes('tell me my name')) {
                    response = memory.name ? `Your name is ${memory.name}, sir.` : 'I don’t believe you’ve told me your name yet.';
                } else if (command.includes('i am') && command.includes('years old')) {
                    const ageMatch = command.match(/\d+/);
                    if (ageMatch) {
                        memory.age = ageMatch[0];
                        response = `Noted, ${memory.name || 'sir'}. You are ${memory.age} years old.`;
                    } else {
                        response = 'I didn’t catch your age. Could you repeat that?';
                    }
                } else if (command.includes('how old am i') || command.includes('what is my age')) {
                    response = memory.age ? `You are ${memory.age} years old, ${memory.name || 'sir'}.` : 'I don’t know your age yet. How old are you?';
                } else if (command.includes('what time is it') || command.includes('tell me the time')) {
                    const now = new Date();
                    const time = now.toLocaleTimeString();
                    response = `The current time is ${time}, ${memory.name || 'sir'}.`;
                } else if (command.includes('what is the date') || command.includes('tell me the date')) {
                    const now = new Date();
                    const date = now.toLocaleDateString();
                    response = `Today is ${date}, ${memory.name || 'sir'}.`;
                } else if (command.includes('search for') || command.includes('look up')) {
                    let query;
                    if (command.includes('search for')) {
                        query = command.split('search for')[1].trim();
                    } else {
                        query = command.split('look up')[1].trim();
                    }
                    const url = `https://www.google.com/search?q=${encodeURIComponent(query)}`;
                    window.open(url, '_blank');
                    response = `Searching for "${query}", ${memory.name || 'sir'}. Opening results now.`;
                } else if (command.includes('stop') || command.includes('shut down')) {
                    recognition.stop();
                    response = 'Shutting down, sir. Goodbye.';
                } else {
                    response = 'I didn’t understand that, sir. Could you clarify?';
                }
                appendMessage(`Jarvis: ${response}`, 'jarvis');
                speak(response);
            }
        } else {
            alert('Your browser does not support the Web Speech API. Please use Google Chrome.');
        }
    </script>
</body>
</html>